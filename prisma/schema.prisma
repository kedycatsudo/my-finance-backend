generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

// ------------ USERS -------------
model Users {
  id                    String         @id @default(uuid()) @db.uuid
  username              String         @unique @db.VarChar(50)
  email                 String         @unique @db.VarChar(100)
  monthly_circle_date   String?        @db.VarChar(10)
  password              String
  created_at            DateTime       @default(now())
  sources               Sources[]      @relation("UserSources")
}

// ------------ SOURCES -------------
model Sources {
  id                String               @id @default(uuid()) @db.uuid
  name              String               @db.VarChar(200)
  description       String?              @db.Text
  date              DateTime?            @db.Date
  type              SourceType
  user_id           String               @db.uuid
  user              Users                @relation(fields: [user_id], references: [id], onDelete: Cascade, name: "UserSources")
  financeSources    FinanceSources[]     @relation("SourceFinanceSources")
  investmentSources InvestmentSources[]  @relation("SourceInvestmentSources")
}

// ------------ ENUMS -------------
enum SourceType {
  finance 
  investment 
}

// ------------ FINANCE SOURCES -------------
model FinanceSources {
  id               String            @id @default(uuid()) @db.uuid
  source_id        String            @db.uuid
  type             FinanceSourceType
  name             String?           @db.VarChar(200)
  source           Sources           @relation(fields: [source_id], references: [id], onDelete: Cascade, name: "SourceFinanceSources")
  financePayments  FinancePayments[] @relation("FinanceSourceFinancePayment")

  @@map("finance_sources")
}

enum FinanceSourceType {
  outcome
  income
}

// ------------ FINANCE PAYMENTS -------------
model FinancePayments {
  id                String           @id @default(uuid()) @db.uuid
  name              String           @db.VarChar(100)
  type              PaymentType
  amount            Decimal
  date              DateTime         @db.Date
  loop              Boolean          @default(false)
  status            PaymentStatus
  financeSource_id  String           @db.uuid
  financeSource     FinanceSources   @relation(fields: [financeSource_id], references: [id], onDelete: Cascade, name: "FinanceSourceFinancePayment")

  @@map("finance_payments")
}

enum PaymentType {
  // Insert your actual enum values from DB, e.g. 'income', 'expense'
}
enum PaymentStatus {
  // Insert your actual enum values from DB, e.g. 'pending', 'completed'
}

// ------------ INVESTMENT SOURCES -------------
model InvestmentSources {
  id               String              @id @default(uuid()) @db.uuid
  type             InvestmentSourceType
  name             String?             @db.VarChar(200)
  source_id        String              @db.uuid
  source           Sources             @relation(fields: [source_id], references: [id], onDelete: Cascade, name: "SourceInvestmentSources")
  investmentItems  InvestmentItems[]   @relation("InvestmentSourceInvestmentItems")

  @@map("investment_sources")
}

enum InvestmentSourceType {
  crypto
  forex
  investment
}

// ------------ INVESTMENT ITEMS -------------
model InvestmentItems {
  id                    String               @id @default(uuid())  @db.uuid
  investment_source_id  String               @db.uuid
  asset_name            String?              @db.VarChar(75)
  term                  InvestmentTerm
  invested_amount       Decimal              @db.Decimal(18,2)
  entry_date            DateTime             @db.Date
  exit_date             DateTime?            @db.Date
  result                InvestmentResult
  result_amount         Decimal?             @db.Decimal(18,2)
  status                InvestmentStatus

  investmentSource      InvestmentSources    @relation(
    fields: [investment_source_id], 
    references: [id], 
    onDelete: Cascade, 
    name: "InvestmentSourceInvestmentItems"
  )

  @@map("investment_items")
}

enum InvestmentTerm {
  short
  middle
  long
}
enum InvestmentResult {
  profit
  loss
  none
}
enum InvestmentStatus {
  // Insert values here that exist in your Postgres enum, e.g. 'active', 'closed', etc.
}